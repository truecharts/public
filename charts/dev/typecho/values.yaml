image:
  repository: tccr.io/truecharts/typecho
  tag: v1.2.0-php8.0@sha256:8116951ff080fbd68797778dd23aa112662f2aac7fccabea3bb9ca929350eda8
  pullPolicy: IfNotPresent
service:
  main:
    ports:
      main:
        port: 10207
        targetPort: 80
persistence:
  config:
    enabled: true
    mountPath: "/app/usr"
mariadb:
  enabled: true
  mariadbUsername: typecho
  mariadbDatabase: typecho

securityContext:
  container:
    readOnlyRootFilesystem: false
    runAsNonRoot: false
    runAsUser: 0
    runAsGroup: 0
workload:
  main:
    podSpec:
      containers:
        main:
          probes:
            liveness:
              type: tcp
            readiness:
              type: tcp
            startup:
              type: tcp
          env:
            TIMEZONE: "{{ .Values.TZ }}"
            TYPECHO_INSTALL: 1
            TYPECHO_DB_ADAPTER: "Pdo_Mysql"
            TYPECHO_DB_PORT: "3306"
            TYPECHO_DB_USER: "{{ .Values.mariadb.mariadbUsername }}"
            TYPECHO_DB_DATABASE: "{{ .Values.mariadb.mariadbDatabase }}"
            TYPECHO_DB_PREFIX: "typecho_"
            TYPECHO_DB_ENGINE: "InnoDB"
            TYPECHO_DB_CHARSET: "utf8mb4"
            TYPECHO_DB_NEXT: "none"
            # User Defined
            MEMORY_LIMIT: "100M"
            MAX_POST_BODY: "50M"
            TYPECHO_SITE_URL: "https://your-domain.com"
            TYPECHO_USER_MAIL: "test@truecharts.org"
            TYPECHO_DB_HOST:
              secretKeyRef:
                expandObjectName: false
                name: '{{ printf "%s-%s" .Release.Name "mariadbcreds" }}'
                key: plainhost
            TYPECHO_DB_PASSWORD:
              secretKeyRef:
                expandObjectName: false
                name: '{{ printf "%s-%s" .Release.Name "mariadbcreds" }}'
                key: mariadb-password
            TYPECHO_USER_NAME: "typecho"
            TYPECHO_USER_PASSWORD: "testtypecho"
