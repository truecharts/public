image:
  repository: tccr.io/truecharts/plex
  pullPolicy: IfNotPresent
  tag: 1.28.0.5999@sha256:1a8ea33f76cd96211243450529ce43c1eb887e4cf36a1ce86bbe00523d3db165

service:
  main:
    ports:
      main:
        protocol: HTTP
        port: 32400
        targetPort: 32400

persistence:
  config:
    enabled: true
    mountPath: "/config"

plex:
  serverURL: "{{ .Values.service.main.ports.main.protocol | lower }}://{{ .Values.env.serverIP }}:{{ .Values.service.main.ports.main.port }}"
  serverIngressURL: "{{ if .Values.ingress.main.enabled }}{{ with (first .Values.ingress.main.hosts) }},https://{{ .host }}{{ end }}{{ end }}"
  serverIngressURLPort: "{{ if .Values.ingress.main.enabled }}{{ with (first .Values.ingress.main.hosts) }},https://{{ .host }}:{{ .Values.service.main.ports.main.port }}{{ end }}{{ end }}"
  # User Defined
  serverIP: "127.0.0.1"
  additionalAdvertiseURL: ""

env:
  ADVERTISE_IP: "{{ tpl (.Values.plex.serverURL) .}}{{ tpl (.Values.plex.serverIngressURL) . }}{{ tpl (.Values.plex.serverIngressURLPort) . }}{{ with .Values.plex.additionalAdvertiseURL }},{{ . }}{{ end }}"
  # User Defined
  ALLOWED_NETWORKS: "172.16.0.0/12,10.0.0.0/8,192.168.0.0/16"
  PLEX_CLAIM: ""

portal:
  enabled: true
