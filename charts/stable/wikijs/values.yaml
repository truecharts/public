image:
  repository: tccr.io/truecharts/wikijs
  tag: v2.5.281@sha256:42e7855b75f637592baeb09000d6831317c5261affedb6e56a6b44428d66aa2c
  pullPolicy: IfNotPresent

env:
  DB_TYPE: "postgres"
  DB_NAME: "{{ .Values.postgresql.postgresqlDatabase }}"
  DB_USER: "{{ .Values.postgresql.postgresqlUsername }}"
  DB_PORT: "5432"

envValueFrom:
  DB_PASS:
    secretKeyRef:
      name: dbcreds
      key: postgresql-password
  DB_HOST:
    secretKeyRef:
      name: dbcreds
      key: plainhost

probes:
  liveness:
    path: "/healthz"
  readiness:
    path: "/healthz"
  startup:
    path: "/healthz"

service:
  main:
    ports:
      main:
        port: 10045
        targetPort: 3000

postgresql:
  enabled: true
  existingSecret: "dbcreds"
  postgresqlUsername: wikijs
  postgresqlDatabase: wikijs


# /wiki/data is a temporary dir. Without mounting as emptyDir it's only writable by root.
# https://docs.requarks.io/en/install/config#data-paths
persistence:
  wikicache:
    enabled: true
    mountPath: "/wiki/data/"
    type: emptyDir
